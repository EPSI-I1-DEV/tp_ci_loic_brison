image: maven:3.5.4-jdk-8

stages:
    - test
    - analyze

unit_test:
    stage: test
    script:
    - mvn clean test
    rules:
        - if: '$CI_COMMIT_BRANCH == "main"'

sonar_analyze:
    stage: analyze
    image: maven:3.6.3-jdk-11
    script:
    - mvn verify sonar:sonar -Dsonar.projectKey=epsi-i1-dev_tp_ci_loic_brison
